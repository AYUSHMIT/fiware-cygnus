<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="refresh" content="5">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript">
            // pregenerated colors 
            var pregeneratedColors = ['#0000FF', '#B22222', '#008000', '#FF8C00', '#DA70D6', '#800080', '#F0E68C'];
            
            // load the chart package from Google
            google.charts.load('current', {packages: ['corechart', 'line']});
            
            // draw the charts once loaded the page
            google.charts.setOnLoadCallback(drawCharts);
            
            // drawing chart function
            function drawCharts() {
                // query for the points
                var jsonData = $.ajax({
                    url: 'http://localhost:8082/points'
                }).done(function(points) {
                    // draw the sources chart
                    // TBD
                    
                    // draw the channels chart
                    var chartColors = [];
                    var channelPoints = points.channel_points;
                    var channelColumns = channelPoints.columns;
                    var channelRows = channelPoints.rows;
                    var data = new google.visualization.DataTable();
                    
                    for (var i in channelColumns) {
                        data.addColumn('number', channelColumns[i]);
                        chartColors.push(pregeneratedColors[i]);
                    } // for

                    data.addRows(channelRows);
                    
                    var options = {
                        hAxis: {
                            title: 'Time (1 unit time are 5 seconds)'
                        },
                        vAxis: {
                            title: 'Number of events'
                        },
                        colors: chartColors
                    };

                    var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                    chart.draw(data, options);
                    
                    // draw the sinks chart
                    // TBD
                });
            } // drawCharts
        </script>
    </head>
    <body>
        <h1>Cygnus Control Panel (beta)</h1>
        <h2>Channels load</h2>
        <div id="chart_div" style="width: 900px; height: 500px"></div>
    </body>
</html>
